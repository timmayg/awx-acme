---
- name: Tasks in this Playbook are for testing purposes only
  hosts: localhost
  gather_facts: false
  tasks:



    - name: Get the public IP address of the network.
      uri:
        url: https://api.ipify.org?format=json
        method: Get
      changed_when: false
      register: public_ip
      until: public_ip.status == 200
      retries: 6
      delay: 10

    - name: Display the public IP address of the network.
      debug:
        msg: "{{ public_ip.json.ip }}


    - name: Timmay HARD STOP this Playbook
      ansible.builtin.meta: end_play



    - name: Create TXT record with value "unique value"
      community.general.cloudflare_dns:
#        account_api_key: "{{ ansible_password }}"
        api_token: "{{ ansible_password }}"
        account_email: "{{ ansible_user }}"
        record: testansible
        type: TXT
        value: this-is-a-unique-value
        state: present    # present (default), absent
        zone: theglens.net
      register: response

    - name: Debug response
      debug:
        var: response

    - name: Debug task parameters
      debug:
        msg:
          - "account_api_key: {{ ansible_password }}"
          - "account_email: {{ ansible_user }}"
          - "record: testansible"
          - "type: A"
          - "value: 2.2.2.2"
          - "state: present"
          - "zone: theglens.net"